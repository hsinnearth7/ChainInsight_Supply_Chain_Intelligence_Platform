<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ChainInsight â€” Supply Chain Intelligence Dashboard</title>
  <style>
:root {
  --bg-primary:#0a0e1a; --bg-secondary:#111827; --bg-card:#1a2235; --bg-card-hover:#1f2a40;
  --border:#2a3555; --text-primary:#f1f5f9; --text-secondary:#94a3b8; --text-muted:#64748b;
  --accent-blue:#3b82f6; --accent-cyan:#06b6d4; --accent-green:#10b981; --accent-yellow:#f59e0b;
  --accent-orange:#f97316; --accent-red:#ef4444; --accent-purple:#8b5cf6;
  --status-normal:#10b981; --status-low:#f59e0b; --status-oos:#ef4444;
}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',system-ui,-apple-system,sans-serif;background:var(--bg-primary);color:var(--text-primary);overflow-x:hidden;-webkit-font-smoothing:antialiased}
::-webkit-scrollbar{width:6px} ::-webkit-scrollbar-track{background:var(--bg-secondary)} ::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
.app{display:flex;height:100vh}

/* Sidebar */
.sidebar{width:260px;background:var(--bg-secondary);border-right:1px solid var(--border);display:flex;flex-direction:column;flex-shrink:0}
.sidebar-hd{padding:20px;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:12px}
.sidebar-icon{width:36px;height:36px;background:linear-gradient(135deg,var(--accent-blue),var(--accent-cyan));border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:16px;color:#fff}
.sidebar-hd h1{font-size:18px;font-weight:700;background:linear-gradient(135deg,var(--accent-blue),var(--accent-cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.sidebar-hd small{display:block;font-size:10px;color:var(--text-muted);letter-spacing:1px;text-transform:uppercase}
.sidebar-nav{flex:1;padding:12px;display:flex;flex-direction:column;gap:2px;overflow-y:auto}
.nav-btn{display:flex;align-items:center;gap:10px;padding:10px 14px;border-radius:8px;cursor:pointer;font-size:13px;color:var(--text-secondary);border:none;background:none;width:100%;text-align:left;font-family:inherit;transition:all .15s}
.nav-btn:hover{background:var(--bg-card);color:var(--text-primary)}
.nav-btn.active{background:rgba(59,130,246,.15);color:var(--accent-blue)}
.sidebar-ft{padding:14px 16px;border-top:1px solid var(--border);display:flex;flex-direction:column;gap:10px}

/* Language Switcher */
.lang-switch{display:flex;align-items:center;gap:8px;font-size:12px;color:var(--text-muted)}
.lang-bar{display:flex;gap:0;border:1px solid var(--border);border-radius:6px;overflow:hidden;flex:1}
.lang-btn{flex:1;padding:5px 0;border:none;background:transparent;color:var(--text-muted);font-size:11px;font-weight:600;cursor:pointer;transition:all .15s;font-family:inherit;text-align:center;border-right:1px solid var(--border)}
.lang-btn:last-child{border-right:none}
.lang-btn:hover{color:var(--text-primary);background:var(--bg-card)}
.lang-btn.on{background:rgba(59,130,246,.2);color:var(--accent-blue)}
.info-row{display:flex;align-items:center;gap:8px;font-size:12px;color:var(--text-muted)}

/* Main */
.main{flex:1;overflow-y:auto;padding:24px}
.main-hd{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;flex-wrap:wrap;gap:10px}
.main-hd h2{font-size:22px;font-weight:700}
.hd-right{display:flex;align-items:center;gap:10px;font-size:13px;color:var(--text-muted)}
.tag-static{display:inline-flex;align-items:center;gap:6px;background:rgba(59,130,246,.15);color:var(--accent-blue);padding:4px 10px;border-radius:20px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}

/* Stats */
.stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:14px;margin-bottom:22px}
.stat{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;padding:16px;transition:all .15s}
.stat:hover{border-color:var(--accent-blue);transform:translateY(-1px)}
.stat-label{font-size:11px;color:var(--text-muted);text-transform:uppercase;letter-spacing:.5px;margin-bottom:6px}
.stat-val{font-size:26px;font-weight:700}
.stat-sub{font-size:11px;color:var(--text-muted);margin-top:4px}

/* Grid */
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:18px;margin-bottom:22px}
.grid3{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;margin-bottom:22px}
@media(max-width:1100px){.grid2,.grid3{grid-template-columns:1fr}}

/* Card */
.card{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;overflow:hidden;margin-bottom:18px}
.card-hd{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;border-bottom:1px solid var(--border)}
.card-hd h3{font-size:14px;font-weight:600}
.card-badge{font-size:11px;padding:2px 8px;border-radius:12px;font-weight:600}
.card-body{padding:18px}
.empty{padding:40px;text-align:center;color:var(--text-muted);font-size:13px}

/* Chart gallery */
.chart-gallery{display:grid;grid-template-columns:repeat(auto-fill,minmax(380px,1fr));gap:18px}
.chart-item{background:var(--bg-card);border:1px solid var(--border);border-radius:12px;overflow:hidden;transition:all .2s}
.chart-item:hover{border-color:var(--accent-blue);transform:translateY(-2px)}
.chart-item img{width:100%;display:block;cursor:pointer;transition:opacity .2s}
.chart-item img:hover{opacity:.9}
.chart-item .chart-info{padding:12px 16px}
.chart-item .chart-title{font-size:13px;font-weight:600;margin-bottom:4px}
.chart-item .chart-desc{font-size:12px;color:var(--text-secondary);line-height:1.5}

/* Pipeline */
.pipeline{display:flex;flex-direction:column;gap:0}
.pipe-step{display:flex;align-items:flex-start;gap:16px;padding:16px 0}
.pipe-num{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:16px;flex-shrink:0;color:#fff}
.pipe-connector{width:2px;height:20px;margin:0 auto;background:var(--border)}
.pipe-content{flex:1}
.pipe-content h4{font-size:14px;font-weight:600;margin-bottom:4px}
.pipe-content p{font-size:12px;color:var(--text-secondary);line-height:1.6}
.pipe-content .technique{font-size:11px;color:var(--accent-cyan);margin-top:4px}

/* Table */
.tbl-wrap{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:13px}
th{text-align:left;padding:10px 14px;font-size:11px;text-transform:uppercase;letter-spacing:.5px;color:var(--text-muted);border-bottom:1px solid var(--border);font-weight:600}
td{padding:11px 14px;border-bottom:1px solid var(--border)}
tr:hover td{background:var(--bg-card-hover)}
.status-tag{font-size:11px;padding:3px 8px;border-radius:4px;font-weight:600}

/* SVG Charts */
.svg-chart{width:100%;overflow:visible}

/* Lightbox */
.lightbox{position:fixed;inset:0;background:rgba(0,0,0,.85);backdrop-filter:blur(6px);display:flex;align-items:center;justify-content:center;z-index:1000;cursor:pointer;animation:fadeIn .2s}
.lightbox img{max-width:92vw;max-height:92vh;border-radius:8px;box-shadow:0 8px 40px rgba(0,0,0,.5)}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}

@media(max-width:768px){.sidebar{display:none}.stats{grid-template-columns:repeat(2,1fr)}.chart-gallery{grid-template-columns:1fr}}
  </style>
</head>
<body>
<div class="app">
  <aside class="sidebar">
    <div class="sidebar-hd">
      <div class="sidebar-icon">C</div>
      <div><h1>ChainInsight</h1><small>Supply Chain Intelligence</small></div>
    </div>
    <nav class="sidebar-nav" id="nav"></nav>
    <div class="sidebar-ft">
      <div class="lang-switch" id="lang-switch"></div>
      <div class="info-row">
        <span style="font-size:14px">ğŸ“Š</span>
        <span id="info-label"></span>
      </div>
    </div>
  </aside>
  <main class="main" id="main"></main>
</div>
<div id="lightbox-root"></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ChainInsight â€” Vanilla JS Dashboard with i18n (zh / en / ja)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const $ = s => document.querySelector(s);
const $$ = s => document.querySelectorAll(s);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  i18n â€” Translation Dictionary
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const I18N = {
  // â”€â”€â”€ Nav & Titles â”€â”€â”€
  nav_overview:      { zh:'åˆ†æç¸½è¦½',         en:'Overview',              ja:'åˆ†ææ¦‚è¦' },
  nav_pipeline:      { zh:'è³‡æ–™ç®¡ç·š',         en:'Data Pipeline',         ja:'ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³' },
  nav_statistical:   { zh:'çµ±è¨ˆåˆ†æ',         en:'Statistical Analysis',  ja:'çµ±è¨ˆåˆ†æ' },
  nav_supplychain:   { zh:'ä¾›æ‡‰éˆå„ªåŒ–',       en:'Supply Chain',          ja:'ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³æœ€é©åŒ–' },
  nav_aiml:          { zh:'AI / ML æ¼”ç®—æ³•',   en:'AI / ML Algorithms',    ja:'AI / ML ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ' },
  nav_health:        { zh:'åº«å­˜å¥åº·',         en:'Inventory Health',      ja:'åœ¨åº«å¥å…¨æ€§' },

  title_overview:    { zh:'åˆ†æç¸½è¦½å„€è¡¨æ¿',        en:'Analytics Overview Dashboard',       ja:'åˆ†ææ¦‚è¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰' },
  title_pipeline:    { zh:'8 æ­¥é©Ÿ ETL è³‡æ–™ç®¡ç·š',   en:'8-Step ETL Data Pipeline',           ja:'8ã‚¹ãƒ†ãƒƒãƒ— ETL ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³' },
  title_statistical: { zh:'çµ±è¨ˆåˆ†æåœ–è¡¨ç¸½è¦½',       en:'Statistical Analysis Gallery',       ja:'çµ±è¨ˆåˆ†æãƒãƒ£ãƒ¼ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼' },
  title_supplychain: { zh:'ä¾›æ‡‰éˆå„ªåŒ–åˆ†æ',         en:'Supply Chain Optimization',          ja:'ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³æœ€é©åŒ–åˆ†æ' },
  title_aiml:        { zh:'AI / ML æ¼”ç®—æ³•åˆ†æ',     en:'AI / ML Algorithm Analysis',         ja:'AI / ML ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ åˆ†æ' },
  title_health:      { zh:'åº«å­˜å¥åº·å„€è¡¨æ¿',         en:'Inventory Health Dashboard',         ja:'åœ¨åº«å¥å…¨æ€§ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰' },

  // â”€â”€â”€ Stats Cards â”€â”€â”€
  stat_total_products:   { zh:'ç”¢å“ç¸½æ•¸',       en:'Total Products',       ja:'è£½å“ç·æ•°' },
  stat_categories:       { zh:'ç”¢å“é¡åˆ¥æ•¸',     en:'Categories',           ja:'ã‚«ãƒ†ã‚´ãƒªæ•°' },
  stat_vendors:          { zh:'ä¾›æ‡‰å•†æ•¸',       en:'Vendors',              ja:'ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼æ•°' },
  stat_avg_cost:         { zh:'å¹³å‡å–®ä½æˆæœ¬',   en:'Avg Unit Cost',        ja:'å¹³å‡å˜ä¾¡' },
  stat_oos_rate:         { zh:'ç¼ºè²¨ç‡',         en:'OOS Rate',             ja:'æ¬ å“ç‡' },
  stat_total_inv_value:  { zh:'åº«å­˜ç¸½åƒ¹å€¼',     en:'Total Inventory Value', ja:'åœ¨åº«ç·é¡' },
  stat_low_stock:        { zh:'ä½åº«å­˜å“é …',     en:'Low Stock Items',      ja:'ä½åœ¨åº«å“ç›®' },
  stat_normal_stock:     { zh:'æ­£å¸¸åº«å­˜å“é …',   en:'Normal Stock Items',   ja:'æ­£å¸¸åœ¨åº«å“ç›®' },

  // â”€â”€â”€ Stock Status â”€â”€â”€
  status_oos:     { zh:'ç¼ºè²¨',     en:'Out of Stock',  ja:'æ¬ å“' },
  status_low:     { zh:'ä½åº«å­˜',   en:'Low Stock',     ja:'ä½åœ¨åº«' },
  status_normal:  { zh:'æ­£å¸¸',     en:'Normal Stock',  ja:'æ­£å¸¸åœ¨åº«' },

  // â”€â”€â”€ Card Headers â”€â”€â”€
  hd_stock_dist:       { zh:'ğŸ“Š åº«å­˜ç‹€æ…‹åˆ†å¸ƒ',         en:'ğŸ“Š Inventory Status Distribution',   ja:'ğŸ“Š åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†å¸ƒ' },
  hd_cat_breakdown:    { zh:'ğŸ“¦ é¡åˆ¥åº«å­˜åˆ†å¸ƒ',         en:'ğŸ“¦ Category Breakdown',              ja:'ğŸ“¦ ã‚«ãƒ†ã‚´ãƒªåˆ¥åœ¨åº«åˆ†å¸ƒ' },
  hd_abc_class:        { zh:'ğŸ¯ ABC åˆ†é¡åˆ†å¸ƒ',         en:'ğŸ¯ ABC Classification',              ja:'ğŸ¯ ABC åˆ†é¡åˆ†å¸ƒ' },
  hd_top_vendors:      { zh:'ğŸ¢ ä¾›æ‡‰å•†åƒ¹å€¼æ’å',       en:'ğŸ¢ Top Vendors by Value',            ja:'ğŸ¢ ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ä¾¡å€¤ãƒ©ãƒ³ã‚­ãƒ³ã‚°' },
  hd_pipeline:         { zh:'ğŸ”§ ETL è³‡æ–™ç®¡ç·š',         en:'ğŸ”§ ETL Data Pipeline',               ja:'ğŸ”§ ETL ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³' },
  hd_data_quality:     { zh:'ğŸ“‹ è³‡æ–™å“è³ªæ‘˜è¦',         en:'ğŸ“‹ Data Quality Summary',            ja:'ğŸ“‹ ãƒ‡ãƒ¼ã‚¿å“è³ªã‚µãƒãƒªãƒ¼' },
  hd_algo_summary:     { zh:'ğŸ¤– 30 æ¼”ç®—æ³•ç¸½è¦½',        en:'ğŸ¤– 30 Algorithm Summary',            ja:'ğŸ¤– 30ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ¦‚è¦' },
  hd_health_kpi:       { zh:'ğŸ’Š åº«å­˜å¥åº· KPI èªªæ˜',    en:'ğŸ’Š Inventory Health KPI Guide',       ja:'ğŸ’Š åœ¨åº«å¥å…¨æ€§ KPI ã‚¬ã‚¤ãƒ‰' },

  // â”€â”€â”€ Pipeline Steps â”€â”€â”€
  pipe1_title: { zh:'Product ID æ¸…ç†',         en:'Product ID Cleanup',          ja:'Product ID ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—' },
  pipe1_desc:  { zh:'å»é™¤å‰å¾Œç©ºç™½å­—å…ƒ',         en:'Strip leading/trailing whitespace', ja:'å‰å¾Œã®ç©ºç™½ã‚’é™¤å»' },
  pipe1_tech:  { zh:'str.strip()',             en:'str.strip()',                 ja:'str.strip()' },

  pipe2_title: { zh:'Category æ¨™æº–åŒ–',         en:'Category Standardization',    ja:'ã‚«ãƒ†ã‚´ãƒªæ¨™æº–åŒ–' },
  pipe2_desc:  { zh:'çµ±ä¸€å¤§å°å¯«ï¼ˆå¦‚ electronics â†’ Electronicsï¼‰', en:'Normalize casing (e.g. electronics â†’ Electronics)', ja:'å¤§å°æ–‡å­—ã®çµ±ä¸€ï¼ˆä¾‹: electronics â†’ Electronicsï¼‰' },
  pipe2_tech:  { zh:'str.strip().str.capitalize()', en:'str.strip().str.capitalize()', ja:'str.strip().str.capitalize()' },

  pipe3_title: { zh:'Unit Cost è§£æ',           en:'Unit Cost Extraction',        ja:'å˜ä¾¡æŠ½å‡º' },
  pipe3_desc:  { zh:'å¾æ··åˆæ ¼å¼æå–æ•¸å€¼ï¼ˆUSD 45.99, $30, Quote Pending â†’ NaNï¼‰', en:'Extract numeric from mixed formats (USD 45.99, $30, Quote Pending â†’ NaN)', ja:'æ··åˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰æ•°å€¤æŠ½å‡ºï¼ˆUSD 45.99, $30, Quote Pending â†’ NaNï¼‰' },
  pipe3_tech:  { zh:"re.sub(r'[^\\d.]', '', val)", en:"re.sub(r'[^\\d.]', '', val)", ja:"re.sub(r'[^\\d.]', '', val)" },

  pipe4_title: { zh:'Current Stock æ­£è¦åŒ–',     en:'Stock Normalization',         ja:'åœ¨åº«æ•°æ­£è¦åŒ–' },
  pipe4_desc:  { zh:'è½‰æ›ç‚ºæ•¸å€¼ï¼Œè² å€¼è¨­ç‚º 0',   en:'Coerce to numeric, clamp negatives to 0', ja:'æ•°å€¤å¤‰æ›ã€è² å€¤ã‚’0ã«' },
  pipe4_tech:  { zh:'pd.to_numeric(errors="coerce")', en:'pd.to_numeric(errors="coerce")', ja:'pd.to_numeric(errors="coerce")' },

  pipe5_title: { zh:'ç©ºå€¼è™•ç†',                 en:'Null Imputation',             ja:'æ¬ æå€¤è£œå®Œ' },
  pipe5_desc:  { zh:'å…©éšæ®µç­–ç•¥ï¼šé¡åˆ¥ä¸­ä½æ•¸ â†’ å…¨åŸŸä¸­ä½æ•¸',  en:'Two-pass: category median â†’ global median fallback', ja:'2æ®µéšæˆ¦ç•¥ï¼šã‚«ãƒ†ã‚´ãƒªä¸­å¤®å€¤ â†’ å…¨ä½“ä¸­å¤®å€¤' },
  pipe5_tech:  { zh:'groupby().transform(median)', en:'groupby().transform(median)', ja:'groupby().transform(median)' },

  pipe6_title: { zh:'Vendor Name æ¸…ç†',         en:'Vendor Name Cleanup',         ja:'ãƒ™ãƒ³ãƒ€ãƒ¼åã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—' },
  pipe6_desc:  { zh:'å»é™¤ç©ºç™½å­—å…ƒ',             en:'Strip whitespace',            ja:'ç©ºç™½é™¤å»' },
  pipe6_tech:  { zh:'str.strip()',             en:'str.strip()',                 ja:'str.strip()' },

  pipe7_title: { zh:'ç¯„åœé©—è­‰',                 en:'Range Validation',            ja:'ç¯„å›²æ¤œè¨¼' },
  pipe7_desc:  { zh:'è£å‰ªè‡³åˆç†ç¯„åœï¼ˆéœ€æ±‚ â‰¥ 0ã€å‰ç½®æ™‚é–“ â‰¥ 1ï¼‰', en:'Clip to valid ranges (demand â‰¥ 0, lead time â‰¥ 1)', ja:'æœ‰åŠ¹ç¯„å›²ã«ã‚¯ãƒªãƒƒãƒ—ï¼ˆéœ€è¦ â‰¥ 0ã€ãƒªãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ  â‰¥ 1ï¼‰' },
  pipe7_tech:  { zh:'.clip(lower=0)',          en:'.clip(lower=0)',              ja:'.clip(lower=0)' },

  pipe8_title: { zh:'è¡ç”Ÿæ¬„ä½è¨ˆç®—',             en:'Derived Fields',              ja:'æ´¾ç”Ÿãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¨ˆç®—' },
  pipe8_desc:  { zh:'Reorder Pointã€Stock Statusã€Inventory Value', en:'Reorder Point, Stock Status, Inventory Value', ja:'Reorder Pointã€Stock Statusã€Inventory Value' },
  pipe8_tech:  { zh:'Demand Ã— Lead Time + Safety Stock', en:'Demand Ã— Lead Time + Safety Stock', ja:'Demand Ã— Lead Time + Safety Stock' },

  // â”€â”€â”€ Pipeline Stats â”€â”€â”€
  pipe_before:       { zh:'æ¸…æ´—å‰',         en:'Before',         ja:'ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å‰' },
  pipe_after:        { zh:'æ¸…æ´—å¾Œ',         en:'After',          ja:'ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œ' },
  pipe_rows:         { zh:'è³‡æ–™åˆ—æ•¸',       en:'Rows',           ja:'è¡Œæ•°' },
  pipe_cols_in:      { zh:'è¼¸å…¥æ¬„ä½',       en:'Input Columns',  ja:'å…¥åŠ›ã‚«ãƒ©ãƒ ' },
  pipe_cols_out:     { zh:'è¼¸å‡ºæ¬„ä½',       en:'Output Columns', ja:'å‡ºåŠ›ã‚«ãƒ©ãƒ ' },
  pipe_issues:       { zh:'è³‡æ–™å“è³ªå•é¡Œ',   en:'Quality Issues', ja:'å“è³ªå•é¡Œ' },
  pipe_issues_val:   { zh:'1,280+ é …',     en:'1,280+ issues',  ja:'1,280ä»¶ä»¥ä¸Š' },
  pipe_derived:      { zh:'è¡ç”Ÿæ¬„ä½',       en:'Derived Fields', ja:'æ´¾ç”Ÿãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰' },

  // â”€â”€â”€ Chart Descriptions â”€â”€â”€
  chart_01_title: { zh:'ç›¸é—œçŸ©é™£åˆ†æ',             en:'Correlation Matrix',             ja:'ç›¸é–¢è¡Œåˆ—åˆ†æ' },
  chart_01_desc:  { zh:'Pearson vs Spearman ç›¸é—œä¿‚æ•¸ç†±åŠ›åœ–ï¼Œå« p å€¼é¡¯è‘—æ€§æª¢å®š', en:'Pearson vs Spearman correlation heatmaps with p-value significance', ja:'Pearson vs Spearman ç›¸é–¢ä¿‚æ•°ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ï¼ˆpå€¤æœ‰æ„æ€§æ¤œå®šä»˜ãï¼‰' },

  chart_02_title: { zh:'åˆ†ä½ˆåˆ†æ',                 en:'Distribution Analysis',          ja:'åˆ†å¸ƒåˆ†æ' },
  chart_02_desc:  { zh:'6 é …é—œéµæŒ‡æ¨™çš„ç›´æ–¹åœ– + KDE + Q-Q åœ–ï¼Œå« Shapiro-Wilk æª¢å®š', en:'Histogram + KDE + Q-Q plots for 6 key metrics with Shapiro-Wilk tests', ja:'6æŒ‡æ¨™ã®ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ  + KDE + Q-Qãƒ—ãƒ­ãƒƒãƒˆï¼ˆShapiro-Wilkæ¤œå®šä»˜ãï¼‰' },

  chart_03_title: { zh:'ä¾›æ‡‰å•†ç¸¾æ•ˆåˆ†æ',           en:'Vendor Performance',             ja:'ãƒ™ãƒ³ãƒ€ãƒ¼ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹' },
  chart_03_desc:  { zh:'ä¾›æ‡‰å•†ç¸¾æ•ˆç®±å‹åœ–ï¼Œå« ANOVA & Kruskal-Wallis æª¢å®š', en:'Vendor performance box plots with ANOVA & Kruskal-Wallis tests', ja:'ãƒ™ãƒ³ãƒ€ãƒ¼ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç®±ã²ã’å›³ï¼ˆANOVA & Kruskal-Wallisæ¤œå®šä»˜ãï¼‰' },

  chart_04_title: { zh:'é¡åˆ¥Ã—ä¾›æ‡‰å•†ç†±åŠ›åœ–',        en:'Category-Vendor Heatmap',        ja:'ã‚«ãƒ†ã‚´ãƒªÃ—ãƒ™ãƒ³ãƒ€ãƒ¼ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—' },
  chart_04_desc:  { zh:'äº¤å‰åˆ†æç†±åŠ›åœ–ï¼Œå«å¡æ–¹ç¨ç«‹æ€§æª¢å®š', en:'Cross-tabulation heatmaps with Chi-square independence test', ja:'ã‚¯ãƒ­ã‚¹é›†è¨ˆãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ï¼ˆã‚«ã‚¤äºŒä¹—æ¤œå®šä»˜ãï¼‰' },

  chart_05_title: { zh:'è¿´æ­¸åˆ†æ',                 en:'Regression Analysis',            ja:'å›å¸°åˆ†æ' },
  chart_05_desc:  { zh:'OLS è¿´æ­¸ï¼Œå« 95% ä¿¡è³´å€é–“èˆ‡ Pearson/Spearman çµ±è¨ˆ', en:'OLS regression with 95% CI for 4 key variable pairs', ja:'OLSå›å¸°ï¼ˆ95%ä¿¡é ¼åŒºé–“ã€4å¤‰æ•°ãƒšã‚¢ï¼‰' },

  chart_06_title: { zh:'é¡åˆ¥é¢¨éšªåˆ†æ',             en:'Category Risk Profile',          ja:'ã‚«ãƒ†ã‚´ãƒªãƒªã‚¹ã‚¯ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«' },
  chart_06_desc:  { zh:'åº«å­˜ç‹€æ…‹åˆ†å¸ƒã€å®‰å…¨åº«å­˜è¦†è“‹ç‡ã€é¢¨éšªå¯†åº¦è©•åˆ†', en:'Stock status distribution, safety stock coverage, risk score density', ja:'åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†å¸ƒã€å®‰å…¨åœ¨åº«ã‚«ãƒãƒ¬ãƒƒã‚¸ã€ãƒªã‚¹ã‚¯ã‚¹ã‚³ã‚¢å¯†åº¦' },

  chart_07_title: { zh:'ç•°å¸¸å€¼èˆ‡é¢¨éšªåˆ†æ',         en:'Outlier Risk Analysis',          ja:'å¤–ã‚Œå€¤ãƒªã‚¹ã‚¯åˆ†æ' },
  chart_07_desc:  { zh:'Z-score & IQR ç•°å¸¸åµæ¸¬ï¼Œéœ€æ±‚å¼·åº¦ vs è¦†è“‹ç‡é¢¨éšªè±¡é™', en:'Z-score & IQR outlier detection, demand intensity vs coverage risk quadrant', ja:'Z-score & IQRå¤–ã‚Œå€¤æ¤œå‡ºã€éœ€è¦å¼·åº¦ vs ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒªã‚¹ã‚¯è±¡é™' },

  chart_08_title: { zh:'è®Šæ•¸é…å°åœ–',               en:'Pairplot Regression',            ja:'å¤‰æ•°ãƒšã‚¢ãƒ—ãƒ­ãƒƒãƒˆ' },
  chart_08_desc:  { zh:'é—œéµè®Šæ•¸é…å°åœ–ï¼ŒæŒ‰åº«å­˜ç‹€æ…‹è‘—è‰²', en:'Key variable pair plot colored by Stock Status', ja:'ã‚­ãƒ¼å¤‰æ•°ãƒšã‚¢ãƒ—ãƒ­ãƒƒãƒˆï¼ˆåœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¥ç€è‰²ï¼‰' },

  chart_09_title: { zh:'EOQ åˆ†æ',                 en:'EOQ Analysis',                   ja:'EOQ åˆ†æ' },
  chart_09_desc:  { zh:'ç¶“æ¿Ÿè¨‚è³¼é‡åˆ†ä½ˆã€æˆæœ¬æ›²ç·šã€è£œè²¨é »ç‡èˆ‡ç¯€çœæ½›åŠ›', en:'EOQ distribution, cost curves, reorder frequency, savings potential', ja:'çµŒæ¸ˆçš„ç™ºæ³¨é‡åˆ†å¸ƒã€ã‚³ã‚¹ãƒˆæ›²ç·šã€ç™ºæ³¨é »åº¦ã€å‰Šæ¸›ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«' },

  chart_10_title: { zh:'ä¾›æ‡‰å•†é›·é”åœ–',             en:'Vendor Radar Chart',             ja:'ãƒ™ãƒ³ãƒ€ãƒ¼ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ' },
  chart_10_desc:  { zh:'å¤šç¶­åº¦ä¾›æ‡‰å•†æ¯”è¼ƒï¼ˆæˆæœ¬ã€è¦†è“‹ç‡ã€ç¼ºè²¨ç‡ã€å‰ç½®æ™‚é–“ï¼‰', en:'Multi-dimensional vendor comparison (cost, coverage, OOS rate, lead time)', ja:'å¤šæ¬¡å…ƒãƒ™ãƒ³ãƒ€ãƒ¼æ¯”è¼ƒï¼ˆã‚³ã‚¹ãƒˆã€ã‚«ãƒãƒ¬ãƒƒã‚¸ã€æ¬ å“ç‡ã€ãƒªãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ ï¼‰' },

  chart_11_title: { zh:'åº«å­˜åƒ¹å€¼æ¨¹ç‹€åœ–',           en:'Inventory Treemap',              ja:'åœ¨åº«ä¾¡å€¤ãƒ„ãƒªãƒ¼ãƒãƒƒãƒ—' },
  chart_11_desc:  { zh:'åº«å­˜åƒ¹å€¼æ¨¹ç‹€åœ– + å·¢ç‹€ç”œç”œåœˆåœ–ï¼ˆé¡åˆ¥Ã—ä¾›æ‡‰å•†ï¼‰', en:'Inventory value treemap + nested donut (category Ã— vendor)', ja:'åœ¨åº«ä¾¡å€¤ãƒ„ãƒªãƒ¼ãƒãƒƒãƒ— + ãƒã‚¹ãƒˆãƒ‰ãƒ¼ãƒŠãƒ„ï¼ˆã‚«ãƒ†ã‚´ãƒªÃ—ãƒ™ãƒ³ãƒ€ãƒ¼ï¼‰' },

  chart_12_title: { zh:'è’™åœ°å¡ç¾…æ¨¡æ“¬',             en:'Monte Carlo Simulation',         ja:'ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³' },
  chart_12_desc:  { zh:'5,000 æ¬¡æ¨¡æ“¬çš„ç¼ºè²¨æ©Ÿç‡ä¼°ç®—ï¼ˆæŒ‰é¡åˆ¥ï¼‰', en:'Stockout probability estimation from 5,000 simulations per category', ja:'ã‚«ãƒ†ã‚´ãƒªåˆ¥5,000å›ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¬ å“ç¢ºç‡æ¨å®š' },

  chart_13_title: { zh:'è£œè²¨ç¼ºå£åˆ†æ',             en:'Reorder Gap Analysis',           ja:'ç™ºæ³¨ã‚®ãƒ£ãƒƒãƒ—åˆ†æ' },
  chart_13_desc:  { zh:'è£œè²¨ç¼ºå£ç€‘å¸ƒåœ–ã€ç·Šæ€¥ SKU æ’åã€å„ªå…ˆè£œè²¨çŸ©é™£', en:'Reorder gap waterfall, top 25 urgent SKUs, replenishment priority matrix', ja:'ç™ºæ³¨ã‚®ãƒ£ãƒƒãƒ—ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«ã€ç·Šæ€¥SKU25ã€è£œå……å„ªå…ˆãƒãƒˆãƒªã‚¯ã‚¹' },

  chart_14_title: { zh:'éœ€æ±‚èˆ‡å®‰å…¨åº«å­˜åˆ†æ',       en:'Demand & Safety Stock',          ja:'éœ€è¦ã¨å®‰å…¨åœ¨åº«åˆ†æ' },
  chart_14_desc:  { zh:'éœ€æ±‚è®Šç•°ä¿‚æ•¸ã€å®‰å…¨åº«å­˜æ¼æ–—ã€æœå‹™æ°´æº–æ›²ç·šã€å‰ç½®æ™‚é–“é¢¨éšª', en:'Demand CV, safety stock funnel, service level curve, lead time risk heatmap', ja:'éœ€è¦å¤‰å‹•ä¿‚æ•°ã€å®‰å…¨åœ¨åº«ãƒ•ã‚¡ãƒãƒ«ã€ã‚µãƒ¼ãƒ“ã‚¹ãƒ¬ãƒ™ãƒ«æ›²ç·šã€ãƒªãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ ãƒªã‚¹ã‚¯' },

  chart_15_title: { zh:'åˆ†é¡æ¼”ç®—æ³•æ¯”è¼ƒ',           en:'Classification Comparison',      ja:'åˆ†é¡ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ¯”è¼ƒ' },
  chart_15_desc:  { zh:'10 ç¨®æ¼”ç®—æ³•ç²¾ç¢ºåº¦æ’åã€äº¤å‰é©—è­‰åˆ†æ•¸ã€éæ“¬åˆæª¢æŸ¥', en:'10-algorithm accuracy ranking, CV scores, overfitting check, top-3 confusion matrices', ja:'10ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ç²¾åº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã€CV ã‚¹ã‚³ã‚¢ã€éå­¦ç¿’ãƒã‚§ãƒƒã‚¯' },

  chart_16_title: { zh:'ç‰¹å¾µé‡è¦æ€§åˆ†æ',           en:'Feature Importance',             ja:'ç‰¹å¾´é‡é‡è¦åº¦' },
  chart_16_desc:  { zh:'RFã€Gradient Boostingã€Decision Treeã€Logistic Regression ç‰¹å¾µé‡è¦æ€§', en:'Feature importance from RF, GB, DT, Logistic Regression', ja:'RFã€GBã€DTã€ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã®ç‰¹å¾´é‡é‡è¦åº¦' },

  chart_17_title: { zh:'è¿´æ­¸é æ¸¬åˆ†æ',             en:'Regression Prediction',          ja:'å›å¸°äºˆæ¸¬åˆ†æ' },
  chart_17_desc:  { zh:'å¯¦éš› vs é æ¸¬æ•£ä½ˆåœ–ï¼ˆ3 æ¨¡å‹ï¼‰ã€RÂ²/RMSE æ¯”è¼ƒã€æ®˜å·®åˆ†ä½ˆ', en:'Actual vs predicted scatter (3 models), RÂ²/RMSE comparison, residual distribution', ja:'å®Ÿæ¸¬ vs äºˆæ¸¬æ•£å¸ƒå›³ï¼ˆ3ãƒ¢ãƒ‡ãƒ«ï¼‰ã€RÂ²/RMSEæ¯”è¼ƒã€æ®‹å·®åˆ†å¸ƒ' },

  chart_18_title: { zh:'åˆ†ç¾¤åˆ†æ',                 en:'Clustering Analysis',            ja:'ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°åˆ†æ' },
  chart_18_desc:  { zh:'æ‰‹è‚˜æ³• + è¼ªå»“ä¿‚æ•¸ã€K-Means++/éšå±¤å¼/DBSCAN çµæœ', en:'Elbow + silhouette, K-Means++/Hierarchical/DBSCAN results, cluster profiles', ja:'ã‚¨ãƒ«ãƒœãƒ¼æ³• + ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°ã€K-Means++/éšå±¤å‹/DBSCANçµæœ' },

  chart_19_title: { zh:'é™ç¶­åˆ†æ (PCA/t-SNE)',     en:'PCA & t-SNE',                    ja:'æ¬¡å…ƒå‰Šæ¸› (PCA/t-SNE)' },
  chart_19_desc:  { zh:'PCA è§£é‡‹è®Šç•°é‡ã€2D æŠ•å½±ï¼ˆæŒ‰ç‹€æ…‹/é¡åˆ¥è‘—è‰²ï¼‰ã€t-SNE åµŒå…¥', en:'PCA variance explained, 2D projections (by status & category), t-SNE embedding', ja:'PCAåˆ†æ•£èª¬æ˜é‡ã€2DæŠ•å½±ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹/ã‚«ãƒ†ã‚´ãƒªåˆ¥ï¼‰ã€t-SNEåŸ‹ã‚è¾¼ã¿' },

  chart_20_title: { zh:'ç•°å¸¸åµæ¸¬',                 en:'Anomaly Detection',              ja:'ç•°å¸¸æ¤œå‡º' },
  chart_20_desc:  { zh:'Isolation Forest + Autoencoder ç•°å¸¸åµæ¸¬ã€äº¤å‰ä¸€è‡´æ€§åˆ†æ', en:'Isolation Forest + Autoencoder anomaly detection, cross-method agreement', ja:'Isolation Forest + ã‚ªãƒ¼ãƒˆã‚¨ãƒ³ã‚³ãƒ¼ãƒ€ç•°å¸¸æ¤œå‡ºã€ã‚¯ãƒ­ã‚¹æ‰‹æ³•ä¸€è‡´åˆ†æ' },

  chart_21_title: { zh:'åŸºå› æ¼”ç®—æ³•æœ€ä½³åŒ–',         en:'Genetic Algorithm',              ja:'éºä¼çš„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ' },
  chart_21_desc:  { zh:'GA æ”¶æ–‚æ›²ç·šã€æœ€ä½³å®‰å…¨åº«å­˜ä¹˜æ•¸ã€æˆæœ¬ç¯€çœã€åŸºå› æ¼”åŒ–è¿½è¹¤', en:'GA convergence, optimal safety stock multipliers, cost savings, gene evolution', ja:'GAåæŸæ›²ç·šã€æœ€é©å®‰å…¨åœ¨åº«ä¿‚æ•°ã€ã‚³ã‚¹ãƒˆå‰Šæ¸›ã€éºä¼å­é€²åŒ–è¿½è·¡' },

  chart_22_title: { zh:'30 æ¼”ç®—æ³•é©ç”¨æ€§çŸ©é™£',      en:'30-Algorithm Overview',          ja:'30ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é©ç”¨ãƒãƒˆãƒªã‚¯ã‚¹' },
  chart_22_desc:  { zh:'30 ç¨® AI æ¼”ç®—æ³•é©ç”¨æ€§çŸ©é™£ï¼ˆå«ç‹€æ…‹ã€åˆ†é¡ã€ç”¨é€”ã€å‡½å¼åº«ï¼‰', en:'30-algorithm suitability matrix with status, category, use case, library', ja:'30ç¨®AIã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é©ç”¨æ€§ãƒãƒˆãƒªã‚¯ã‚¹ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€åˆ†é¡ã€ç”¨é€”ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰' },

  chart_0_title:  { zh:'åº«å­˜å¥åº·èˆ‡ç¼ºè²¨é¢¨éšª',       en:'Inventory Health & Stockout Risk', ja:'åœ¨åº«å¥å…¨æ€§ã¨æ¬ å“ãƒªã‚¹ã‚¯' },
  chart_0_desc:   { zh:'KPI å¡ç‰‡ã€åº«å­˜æ•ˆç‡çŸ©é™£ã€ABC Pareto åˆ†æã€ç¼ºè²¨è­¦å ±è¡¨', en:'KPI cards, inventory efficiency scatter, ABC Pareto, stockout alert table', ja:'KPIã‚«ãƒ¼ãƒ‰ã€åœ¨åº«åŠ¹ç‡ãƒãƒˆãƒªã‚¯ã‚¹ã€ABC ãƒ‘ãƒ¬ãƒ¼ãƒˆåˆ†æã€æ¬ å“ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨' },

  // â”€â”€â”€ Algorithm Table â”€â”€â”€
  algo_num:       { zh:'#',         en:'#',         ja:'#' },
  algo_name:      { zh:'æ¼”ç®—æ³•',   en:'Algorithm',  ja:'ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ' },
  algo_category:  { zh:'åˆ†é¡',     en:'Category',   ja:'ã‚«ãƒ†ã‚´ãƒª' },
  algo_status:    { zh:'ç‹€æ…‹',     en:'Status',     ja:'ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹' },
  algo_usecase:   { zh:'ä¾›æ‡‰éˆæ‡‰ç”¨', en:'Supply Chain Use Case', ja:'ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³å¿œç”¨' },

  // â”€â”€â”€ Health KPIs â”€â”€â”€
  kpi_dsi:           { zh:'DSI (Days Sales of Inventory)', en:'DSI (Days Sales of Inventory)', ja:'DSIï¼ˆåœ¨åº«æ—¥æ•°ï¼‰' },
  kpi_dsi_desc:      { zh:'åº«å­˜å¯ä¾›éŠ·å”®å¤©æ•¸ = ç¾æœ‰åº«å­˜ / æ¯æ—¥éœ€æ±‚', en:'Days of inventory on hand = Current Stock / Daily Demand', ja:'åœ¨åº«ãŒä½•æ—¥åˆ†ã‚ã‚‹ã‹ = ç¾åœ¨åº« / æ—¥æ¬¡éœ€è¦' },
  kpi_abc:           { zh:'ABC åˆ†é¡', en:'ABC Classification', ja:'ABC åˆ†é¡' },
  kpi_abc_desc:      { zh:'A (å‰ 80% åƒ¹å€¼) / B (80-95%) / C (95-100%)ï¼ŒåŸºæ–¼ Pareto æ³•å‰‡', en:'A (top 80% value) / B (80-95%) / C (95-100%), based on Pareto principle', ja:'Aï¼ˆä¸Šä½80%ä¾¡å€¤ï¼‰/ Bï¼ˆ80-95%ï¼‰/ Cï¼ˆ95-100%ï¼‰ã€ãƒ‘ãƒ¬ãƒ¼ãƒˆæ³•å‰‡ã«åŸºã¥ã' },
  kpi_reorder:       { zh:'Reorder Point', en:'Reorder Point', ja:'ç™ºæ³¨ç‚¹' },
  kpi_reorder_desc:  { zh:'è§¸ç™¼è£œè²¨çš„åº«å­˜æ°´ä½ = éœ€æ±‚ Ã— å‰ç½®æ™‚é–“ + å®‰å…¨åº«å­˜', en:'Stock level triggering replenishment = Demand Ã— Lead Time + Safety Stock', ja:'è£œå……ãƒˆãƒªã‚¬ãƒ¼ã®åœ¨åº«æ°´æº– = éœ€è¦ Ã— ãƒªãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ  + å®‰å…¨åœ¨åº«' },
  kpi_oos:           { zh:'OOS Rate (ç¼ºè²¨ç‡)', en:'OOS Rate (Out of Stock)', ja:'æ¬ å“ç‡ï¼ˆOOS Rateï¼‰' },
  kpi_oos_desc:      { zh:'åº«å­˜ç‚º 0 çš„å“é …ä½”æ¯”ï¼Œåæ˜ ä¾›æ‡‰éˆå¯é æ€§', en:'Percentage of items with zero stock, reflects supply chain reliability', ja:'åœ¨åº«ã‚¼ãƒ­å“ç›®ã®å‰²åˆã€ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³ã®ä¿¡é ¼æ€§ã‚’åæ˜ ' },

  // â”€â”€â”€ Labels / UI â”€â”€â”€
  loading:         { zh:'è¼‰å…¥ä¸­...',           en:'Loading...',             ja:'èª­ã¿è¾¼ã¿ä¸­...' },
  data_source:     { zh:'è³‡æ–™ä¾†æºï¼šSupply_Chain_Inventory_Clean.csv', en:'Data Source: Supply_Chain_Inventory_Clean.csv', ja:'ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼šSupply_Chain_Inventory_Clean.csv' },
  click_enlarge:   { zh:'é»æ“Šåœ–ç‰‡æ”¾å¤§',       en:'Click image to enlarge', ja:'ã‚¯ãƒªãƒƒã‚¯ã§æ‹¡å¤§' },
  items:           { zh:'é …',                 en:'items',                  ja:'ä»¶' },
  products:        { zh:'é …ç”¢å“',             en:'products',               ja:'è£½å“' },
  value_unit:      { zh:'$',                 en:'$',                      ja:'$' },
  applied:         { zh:'å·²æ‡‰ç”¨',             en:'Applied',                ja:'é©ç”¨æ¸ˆ' },
  not_applicable:  { zh:'N/A (éœ€ä¸åŒè³‡æ–™)',   en:'N/A (needs different data)', ja:'N/Aï¼ˆç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿ãŒå¿…è¦ï¼‰' },

  // â”€â”€â”€ Language â”€â”€â”€
  lang_label: { zh:'ğŸŒ', en:'ğŸŒ', ja:'ğŸŒ' },
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
//  i18n runtime
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LANGS = [
  { code:'zh', label:'ä¸­æ–‡' },
  { code:'en', label:'EN' },
  { code:'ja', label:'æ—¥æœ¬èª' },
];

function t(key) {
  const entry = I18N[key];
  if (!entry) return key;
  return entry[S.lang] || entry.zh || key;
}

function localeDateStr() {
  const loc = S.lang === 'ja' ? 'ja-JP' : S.lang === 'en' ? 'en-US' : 'zh-TW';
  const n = new Date();
  return n.toLocaleDateString(loc, { year:'numeric', month:'long', day:'numeric' });
}

// â”€â”€â”€ State â”€â”€â”€
const S = {
  lang: localStorage.getItem('ci_lang') || 'zh',
  view: 'overview',
  data: null,
  loading: true,
};

// â”€â”€â”€ Helpers â”€â”€â”€
function esc(s) { const d = document.createElement('div'); d.textContent = s; return d.innerHTML; }
function fmt(n) { return n.toLocaleString(S.lang === 'ja' ? 'ja-JP' : S.lang === 'en' ? 'en-US' : 'zh-TW'); }
function fmtCurrency(n) { return '$' + fmt(Math.round(n)); }

const COLORS = {
  'Electronics':'#3b82f6','Home':'#10b981','Food':'#f59e0b','Shipping':'#8b5cf6',
  'Office':'#f97316','Apparel':'#ec4899','Industrial':'#06b6d4'
};
const STATUS_COLORS = {'Out of Stock':'var(--status-oos)','Low Stock':'var(--status-low)','Normal Stock':'var(--status-normal)'};
const PIPE_COLORS = ['#3b82f6','#06b6d4','#10b981','#f59e0b','#f97316','#ef4444','#8b5cf6','#ec4899'];

const NAV_KEYS = [
  {id:'overview',    icon:'ğŸ“Š', key:'nav_overview'},
  {id:'pipeline',    icon:'ğŸ”§', key:'nav_pipeline'},
  {id:'statistical', icon:'ğŸ“ˆ', key:'nav_statistical'},
  {id:'supplychain', icon:'ğŸ­', key:'nav_supplychain'},
  {id:'aiml',        icon:'ğŸ¤–', key:'nav_aiml'},
  {id:'health',      icon:'ğŸ’Š', key:'nav_health'},
];

const TITLE_MAP = {
  overview:'title_overview', pipeline:'title_pipeline', statistical:'title_statistical',
  supplychain:'title_supplychain', aiml:'title_aiml', health:'title_health'
};

// â”€â”€â”€ CSV Parser â”€â”€â”€
function parseCSV(text) {
  const lines = text.trim().split('\n');
  const headers = lines[0].split(',').map(h => h.trim());
  const rows = [];
  for (let i = 1; i < lines.length; i++) {
    const vals = lines[i].split(',');
    if (vals.length < headers.length) continue;
    const obj = {};
    headers.forEach((h, j) => {
      const v = (vals[j] || '').trim();
      obj[h] = isNaN(v) || v === '' ? v : parseFloat(v);
    });
    rows.push(obj);
  }
  return rows;
}

// â”€â”€â”€ Compute KPIs from data â”€â”€â”€
function computeKPIs(data) {
  const total = data.length;
  const categories = new Set(data.map(r => r.Category));
  const vendors = new Set(data.map(r => r.Vendor_Name));
  const avgCost = data.reduce((s, r) => s + (r.Unit_Cost || 0), 0) / total;
  const oos = data.filter(r => r.Stock_Status === 'Out of Stock').length;
  const low = data.filter(r => r.Stock_Status === 'Low Stock').length;
  const normal = data.filter(r => r.Stock_Status === 'Normal Stock').length;
  const totalValue = data.reduce((s, r) => s + (r.Inventory_Value || 0), 0);

  // Category breakdown
  const catBreakdown = {};
  data.forEach(r => {
    if (!catBreakdown[r.Category]) catBreakdown[r.Category] = { count: 0, value: 0, stock: 0 };
    catBreakdown[r.Category].count++;
    catBreakdown[r.Category].value += r.Inventory_Value || 0;
    catBreakdown[r.Category].stock += r.Current_Stock || 0;
  });

  // Vendor breakdown
  const vendorBreakdown = {};
  data.forEach(r => {
    if (!vendorBreakdown[r.Vendor_Name]) vendorBreakdown[r.Vendor_Name] = { count: 0, value: 0 };
    vendorBreakdown[r.Vendor_Name].count++;
    vendorBreakdown[r.Vendor_Name].value += r.Inventory_Value || 0;
  });

  // ABC classification
  const sorted = [...data].filter(r => r.Inventory_Value > 0).sort((a, b) => b.Inventory_Value - a.Inventory_Value);
  const cumVal = [];
  let running = 0;
  sorted.forEach(r => { running += r.Inventory_Value; cumVal.push(running); });
  const totalVal = running;
  let aCount = 0, bCount = 0, cCount = 0;
  sorted.forEach((r, i) => {
    const pct = cumVal[i] / totalVal;
    if (pct <= 0.8) aCount++;
    else if (pct <= 0.95) bCount++;
    else cCount++;
  });

  return {
    total, categories: categories.size, vendors: vendors.size,
    avgCost, oosRate: (oos / total * 100), oosCount: oos, lowCount: low, normalCount: normal,
    totalValue, catBreakdown, vendorBreakdown,
    abc: { a: aCount, b: bCount, c: cCount }
  };
}

// â”€â”€â”€ Load Data â”€â”€â”€
async function loadData() {
  try {
    const resp = await fetch('Supply_Chain_Inventory_Clean.csv');
    const text = await resp.text();
    S.data = parseCSV(text);
    S.loading = false;
  } catch (e) {
    S.loading = false;
    S.data = null;
  }
  render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Render Functions
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function renderLangSwitch() {
  const el = $('#lang-switch');
  if (!el) return;
  el.innerHTML = `<span>${t('lang_label')}</span><div class="lang-bar">${LANGS.map(l =>
    `<button class="lang-btn ${S.lang===l.code?'on':''}" data-lang="${l.code}">${l.label}</button>`
  ).join('')}</div>`;
  el.querySelectorAll('.lang-btn').forEach(b => b.onclick = () => {
    S.lang = b.dataset.lang;
    localStorage.setItem('ci_lang', S.lang);
    render();
    renderLangSwitch();
  });
}

function renderNav() {
  const n = $('#nav');
  n.innerHTML = NAV_KEYS.map(i => `
    <button class="nav-btn ${S.view===i.id?'active':''}" data-nav="${i.id}">
      <span style="font-size:15px">${i.icon}</span> ${t(i.key)}
    </button>`).join('');
  n.querySelectorAll('.nav-btn').forEach(b => b.onclick = () => { S.view = b.dataset.nav; render(); });
}

function statsHTML(kpi) {
  const items = [
    {l:t('stat_total_products'),  v:fmt(kpi.total),           c:'var(--accent-blue)'},
    {l:t('stat_categories'),      v:kpi.categories,           c:'var(--accent-cyan)'},
    {l:t('stat_vendors'),         v:kpi.vendors,              c:'var(--accent-purple)'},
    {l:t('stat_avg_cost'),        v:'$'+kpi.avgCost.toFixed(2), c:'var(--accent-green)'},
    {l:t('stat_oos_rate'),        v:kpi.oosRate.toFixed(1)+'%', c:'var(--accent-red)'},
    {l:t('stat_total_inv_value'), v:fmtCurrency(kpi.totalValue), c:'var(--accent-orange)', sub:fmt(kpi.total)+' '+t('products')},
  ];
  return `<div class="stats">${items.map(i=>`<div class="stat"><div class="stat-label">${i.l}</div><div class="stat-val" style="color:${i.c}">${i.v}</div>${i.sub?`<div class="stat-sub">${i.sub}</div>`:''}</div>`).join('')}</div>`;
}

// â”€â”€â”€ SVG Pie Chart â”€â”€â”€
function svgPie(data, size) {
  const W = size, cx = W/2, cy = W/2, r = W/2 - 10;
  const total = data.reduce((s,d) => s + d.value, 0);
  let angle = -Math.PI/2;
  let paths = '';
  let legend = '';
  data.forEach((d, i) => {
    const slice = (d.value / total) * Math.PI * 2;
    const x1 = cx + r * Math.cos(angle);
    const y1 = cy + r * Math.sin(angle);
    const x2 = cx + r * Math.cos(angle + slice);
    const y2 = cy + r * Math.sin(angle + slice);
    const large = slice > Math.PI ? 1 : 0;
    paths += `<path d="M${cx},${cy} L${x1},${y1} A${r},${r} 0 ${large} 1 ${x2},${y2} Z" fill="${d.color}" opacity="0.85"><title>${d.label}: ${d.value} (${(d.value/total*100).toFixed(1)}%)</title></path>`;
    const pct = (d.value / total * 100).toFixed(1);
    legend += `<div style="display:flex;align-items:center;gap:6px;font-size:12px"><div style="width:10px;height:10px;border-radius:3px;background:${d.color}"></div><span style="color:var(--text-secondary)">${d.label}</span><span style="margin-left:auto;font-weight:600">${d.value} (${pct}%)</span></div>`;
    angle += slice;
  });
  return `<div style="display:flex;align-items:center;gap:20px;flex-wrap:wrap"><svg width="${W}" height="${W}" viewBox="0 0 ${W} ${W}">${paths}</svg><div style="display:flex;flex-direction:column;gap:6px;flex:1;min-width:140px">${legend}</div></div>`;
}

// â”€â”€â”€ SVG Bar Chart â”€â”€â”€
function svgBars(data, width, height) {
  const W = width, H = height, PAD_L = 100, PAD_R = 60, PAD_T = 10, PAD_B = 10;
  const maxVal = Math.max(...data.map(d => d.value));
  const barH = Math.min(28, (H - PAD_T - PAD_B) / data.length - 4);
  let bars = '';
  data.forEach((d, i) => {
    const y = PAD_T + i * (barH + 4);
    const w = maxVal > 0 ? (d.value / maxVal) * (W - PAD_L - PAD_R) : 0;
    bars += `<text x="${PAD_L-8}" y="${y+barH/2+4}" fill="var(--text-secondary)" font-size="11" text-anchor="end">${esc(d.label)}</text>`;
    bars += `<rect x="${PAD_L}" y="${y}" width="${w}" height="${barH}" rx="4" fill="${d.color}" opacity="0.8"><title>${d.label}: ${typeof d.display !== 'undefined' ? d.display : fmt(Math.round(d.value))}</title></rect>`;
    bars += `<text x="${PAD_L+w+6}" y="${y+barH/2+4}" fill="var(--text-primary)" font-size="11" font-weight="600">${typeof d.display !== 'undefined' ? d.display : fmt(Math.round(d.value))}</text>`;
  });
  return `<svg width="100%" viewBox="0 0 ${W} ${H}" class="svg-chart">${bars}</svg>`;
}

// â”€â”€â”€ SVG Donut â”€â”€â”€
function svgDonut(data, size) {
  const W = size, cx = W/2, cy = W/2, R = W/2 - 10, r = R * 0.55;
  const total = data.reduce((s,d) => s + d.value, 0);
  let angle = -Math.PI/2;
  let paths = '';
  data.forEach(d => {
    const slice = (d.value / total) * Math.PI * 2;
    if (slice <= 0) { angle += slice; return; }
    const x1o = cx + R * Math.cos(angle), y1o = cy + R * Math.sin(angle);
    const x2o = cx + R * Math.cos(angle + slice), y2o = cy + R * Math.sin(angle + slice);
    const x1i = cx + r * Math.cos(angle + slice), y1i = cy + r * Math.sin(angle + slice);
    const x2i = cx + r * Math.cos(angle), y2i = cy + r * Math.sin(angle);
    const large = slice > Math.PI ? 1 : 0;
    paths += `<path d="M${x1o},${y1o} A${R},${R} 0 ${large} 1 ${x2o},${y2o} L${x1i},${y1i} A${r},${r} 0 ${large} 0 ${x2i},${y2i} Z" fill="${d.color}" opacity="0.85"><title>${d.label}: ${d.value} (${(d.value/total*100).toFixed(1)}%)</title></path>`;
    angle += slice;
  });
  // Center text
  paths += `<text x="${cx}" y="${cy-6}" fill="var(--text-primary)" font-size="18" font-weight="700" text-anchor="middle">${total}</text>`;
  paths += `<text x="${cx}" y="${cy+12}" fill="var(--text-muted)" font-size="10" text-anchor="middle">${t('items')}</text>`;
  let legend = '';
  data.forEach(d => {
    const pct = (d.value / total * 100).toFixed(1);
    legend += `<div style="display:flex;align-items:center;gap:6px;font-size:12px"><div style="width:10px;height:10px;border-radius:3px;background:${d.color}"></div><span style="color:var(--text-secondary)">${d.label}</span><span style="margin-left:auto;font-weight:600">${pct}%</span></div>`;
  });
  return `<div style="display:flex;align-items:center;gap:20px;flex-wrap:wrap"><svg width="${W}" height="${W}" viewBox="0 0 ${W} ${W}">${paths}</svg><div style="display:flex;flex-direction:column;gap:6px;flex:1;min-width:120px">${legend}</div></div>`;
}

// â”€â”€â”€ Chart Gallery Item â”€â”€â”€
function chartItemHTML(file, titleKey, descKey) {
  return `<div class="chart-item">
    <img src="${file}" alt="${t(titleKey)}" loading="lazy" onclick="openLightbox(this.src)">
    <div class="chart-info">
      <div class="chart-title">${t(titleKey)}</div>
      <div class="chart-desc">${t(descKey)}</div>
    </div>
  </div>`;
}

// â”€â”€â”€ Lightbox â”€â”€â”€
function openLightbox(src) {
  const root = $('#lightbox-root');
  root.innerHTML = `<div class="lightbox" onclick="closeLightbox()"><img src="${src}"></div>`;
}
function closeLightbox() {
  $('#lightbox-root').innerHTML = '';
}

// â”€â”€â”€ Views â”€â”€â”€
function overviewHTML() {
  if (!S.data) return `<div class="empty">${t('loading')}</div>`;
  const kpi = computeKPIs(S.data);

  // Pie: Stock Status Distribution
  const pieData = [
    {label:t('status_oos'), value:kpi.oosCount, color:'var(--status-oos)'},
    {label:t('status_low'), value:kpi.lowCount, color:'var(--status-low)'},
    {label:t('status_normal'), value:kpi.normalCount, color:'var(--status-normal)'},
  ];

  // Bar: Category breakdown by value
  const catEntries = Object.entries(kpi.catBreakdown).sort((a,b) => b[1].value - a[1].value);
  const barData = catEntries.map(([cat, d]) => ({
    label: cat, value: d.value, display: fmtCurrency(d.value), color: COLORS[cat] || '#3b82f6'
  }));

  // Donut: ABC classification
  const abcData = [
    {label:'A (80%)', value:kpi.abc.a, color:'var(--accent-red)'},
    {label:'B (15%)', value:kpi.abc.b, color:'var(--accent-yellow)'},
    {label:'C (5%)',  value:kpi.abc.c, color:'var(--accent-green)'},
  ];

  // Top vendors
  const vendorEntries = Object.entries(kpi.vendorBreakdown).sort((a,b) => b[1].value - a[1].value);
  const vendorBarData = vendorEntries.map(([name, d]) => ({
    label: name, value: d.value, display: fmtCurrency(d.value), color: 'var(--accent-blue)'
  }));

  let html = statsHTML(kpi);
  html += `<div class="grid2">`;
  html += `<div class="card"><div class="card-hd"><h3>${t('hd_stock_dist')}</h3></div><div class="card-body">${svgPie(pieData, 180)}</div></div>`;
  html += `<div class="card"><div class="card-hd"><h3>${t('hd_cat_breakdown')}</h3></div><div class="card-body">${svgBars(barData, 500, barData.length * 32 + 20)}</div></div>`;
  html += `</div>`;
  html += `<div class="grid2">`;
  html += `<div class="card"><div class="card-hd"><h3>${t('hd_abc_class')}</h3></div><div class="card-body">${svgDonut(abcData, 180)}</div></div>`;
  html += `<div class="card"><div class="card-hd"><h3>${t('hd_top_vendors')}</h3></div><div class="card-body">${svgBars(vendorBarData, 500, vendorBarData.length * 32 + 20)}</div></div>`;
  html += `</div>`;
  return html;
}

function pipelineHTML() {
  let html = '';

  // Before/After stats
  html += `<div class="grid2" style="margin-bottom:20px">`;
  html += `<div class="card"><div class="card-hd"><h3>${t('pipe_before')}</h3><span class="card-badge" style="background:rgba(239,68,68,.15);color:var(--accent-red)">Raw</span></div><div class="card-body">
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div><div class="stat-label">${t('pipe_rows')}</div><div style="font-size:20px;font-weight:700;color:var(--accent-yellow)">10,050</div></div>
      <div><div class="stat-label">${t('pipe_cols_in')}</div><div style="font-size:20px;font-weight:700;color:var(--accent-yellow)">8</div></div>
      <div><div class="stat-label">${t('pipe_issues')}</div><div style="font-size:20px;font-weight:700;color:var(--accent-red)">${t('pipe_issues_val')}</div></div>
    </div></div></div>`;
  html += `<div class="card"><div class="card-hd"><h3>${t('pipe_after')}</h3><span class="card-badge" style="background:rgba(16,185,129,.15);color:var(--accent-green)">Clean</span></div><div class="card-body">
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
      <div><div class="stat-label">${t('pipe_rows')}</div><div style="font-size:20px;font-weight:700;color:var(--accent-green)">10,050</div></div>
      <div><div class="stat-label">${t('pipe_cols_out')}</div><div style="font-size:20px;font-weight:700;color:var(--accent-green)">11</div></div>
      <div><div class="stat-label">${t('pipe_derived')}</div><div style="font-size:20px;font-weight:700;color:var(--accent-cyan)">3</div></div>
    </div></div></div>`;
  html += `</div>`;

  // Pipeline steps
  html += `<div class="card"><div class="card-hd"><h3>${t('hd_pipeline')}</h3><span class="card-badge" style="background:rgba(59,130,246,.15);color:var(--accent-blue)">8 Steps</span></div><div class="card-body">`;
  for (let i = 1; i <= 8; i++) {
    html += `<div class="pipe-step">
      <div class="pipe-num" style="background:${PIPE_COLORS[i-1]}">${i}</div>
      <div class="pipe-content">
        <h4>${t('pipe'+i+'_title')}</h4>
        <p>${t('pipe'+i+'_desc')}</p>
        <div class="technique">${t('pipe'+i+'_tech')}</div>
      </div>
    </div>`;
    if (i < 8) html += `<div class="pipe-connector"></div>`;
  }
  html += `</div></div>`;
  return html;
}

function statisticalHTML() {
  const charts = [
    {file:'chart_01_correlation_matrix.png',    title:'chart_01_title', desc:'chart_01_desc'},
    {file:'chart_02_distribution_analysis.png', title:'chart_02_title', desc:'chart_02_desc'},
    {file:'chart_03_vendor_performance.png',    title:'chart_03_title', desc:'chart_03_desc'},
    {file:'chart_04_category_vendor_heatmap.png',title:'chart_04_title',desc:'chart_04_desc'},
    {file:'chart_05_regression_analysis.png',   title:'chart_05_title', desc:'chart_05_desc'},
    {file:'chart_06_category_risk_profile.png', title:'chart_06_title', desc:'chart_06_desc'},
    {file:'chart_07_outlier_risk_analysis.png', title:'chart_07_title', desc:'chart_07_desc'},
    {file:'chart_08_pairplot_regression.png',   title:'chart_08_title', desc:'chart_08_desc'},
  ];
  let html = `<p style="font-size:13px;color:var(--text-muted);margin-bottom:16px">${t('click_enlarge')}</p>`;
  html += `<div class="chart-gallery">${charts.map(c => chartItemHTML(c.file, c.title, c.desc)).join('')}</div>`;
  return html;
}

function supplychainHTML() {
  const charts = [
    {file:'chart_09_eoq_analysis.png',           title:'chart_09_title', desc:'chart_09_desc'},
    {file:'chart_10_vendor_radar.png',            title:'chart_10_title', desc:'chart_10_desc'},
    {file:'chart_11_inventory_treemap.png',       title:'chart_11_title', desc:'chart_11_desc'},
    {file:'chart_12_monte_carlo_stockout.png',    title:'chart_12_title', desc:'chart_12_desc'},
    {file:'chart_13_reorder_gap_waterfall.png',   title:'chart_13_title', desc:'chart_13_desc'},
    {file:'chart_14_demand_safety_stock.png',     title:'chart_14_title', desc:'chart_14_desc'},
  ];
  let html = `<p style="font-size:13px;color:var(--text-muted);margin-bottom:16px">${t('click_enlarge')}</p>`;
  html += `<div class="chart-gallery">${charts.map(c => chartItemHTML(c.file, c.title, c.desc)).join('')}</div>`;
  return html;
}

function aimlHTML() {
  const charts = [
    {file:'chart_15_classification_comparison.png', title:'chart_15_title', desc:'chart_15_desc'},
    {file:'chart_16_feature_importance.png',         title:'chart_16_title', desc:'chart_16_desc'},
    {file:'chart_17_regression_prediction.png',      title:'chart_17_title', desc:'chart_17_desc'},
    {file:'chart_18_clustering_analysis.png',        title:'chart_18_title', desc:'chart_18_desc'},
    {file:'chart_19_pca_tsne.png',                   title:'chart_19_title', desc:'chart_19_desc'},
    {file:'chart_20_anomaly_detection.png',           title:'chart_20_title', desc:'chart_20_desc'},
    {file:'chart_21_genetic_algorithm.png',           title:'chart_21_title', desc:'chart_21_desc'},
    {file:'chart_22_algorithm_overview.png',          title:'chart_22_title', desc:'chart_22_desc'},
  ];

  // Algorithm summary table
  const algos = [
    {n:1,  name:'Linear Regression',     cat:{zh:'è¿´æ­¸',en:'Regression',ja:'å›å¸°'},         status:true,  uc:{zh:'åº«å­˜åƒ¹å€¼é æ¸¬',en:'Inventory value prediction',ja:'åœ¨åº«ä¾¡å€¤äºˆæ¸¬'}},
    {n:2,  name:'Logistic Regression',   cat:{zh:'åˆ†é¡',en:'Classification',ja:'åˆ†é¡'},     status:true,  uc:{zh:'åº«å­˜ç‹€æ…‹åˆ†é¡',en:'Stock status classification',ja:'åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†é¡'}},
    {n:3,  name:'Decision Tree',         cat:{zh:'åˆ†é¡',en:'Classification',ja:'åˆ†é¡'},     status:true,  uc:{zh:'åº«å­˜ç‹€æ…‹åˆ†é¡',en:'Stock status classification',ja:'åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†é¡'}},
    {n:4,  name:'Random Forest',         cat:{zh:'é›†æˆ',en:'Ensemble',ja:'ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«'},   status:true,  uc:{zh:'åˆ†é¡ + è¿´æ­¸',en:'Classification + Regression',ja:'åˆ†é¡ + å›å¸°'}},
    {n:5,  name:'SVM',                   cat:{zh:'æ ¸æ–¹æ³•',en:'Kernel',ja:'ã‚«ãƒ¼ãƒãƒ«'},       status:true,  uc:{zh:'åº«å­˜ç‹€æ…‹åˆ†é¡',en:'Stock status classification',ja:'åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†é¡'}},
    {n:6,  name:'k-NN',                  cat:{zh:'å¯¦ä¾‹',en:'Instance',ja:'ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹'},   status:true,  uc:{zh:'åº«å­˜ç‹€æ…‹åˆ†é¡',en:'Stock status classification',ja:'åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†é¡'}},
    {n:7,  name:'Naive Bayes',           cat:{zh:'æ©Ÿç‡',en:'Probabilistic',ja:'ç¢ºç‡'},     status:true,  uc:{zh:'åº«å­˜ç‹€æ…‹åˆ†é¡',en:'Stock status classification',ja:'åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†é¡'}},
    {n:8,  name:'Gradient Boosting',     cat:{zh:'é›†æˆ',en:'Ensemble',ja:'ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«'},   status:true,  uc:{zh:'åˆ†é¡ + è¿´æ­¸',en:'Classification + Regression',ja:'åˆ†é¡ + å›å¸°'}},
    {n:9,  name:'AdaBoost',              cat:{zh:'é›†æˆ',en:'Ensemble',ja:'ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«'},   status:true,  uc:{zh:'åº«å­˜ç‹€æ…‹åˆ†é¡',en:'Stock status classification',ja:'åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†é¡'}},
    {n:10, name:'XGBoost',               cat:{zh:'é›†æˆ',en:'Ensemble',ja:'ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«'},   status:true,  uc:{zh:'åº«å­˜ç‹€æ…‹åˆ†é¡',en:'Stock status classification',ja:'åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†é¡'}},
    {n:11, name:'K-Means',               cat:{zh:'åˆ†ç¾¤',en:'Clustering',ja:'ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°'}, status:true, uc:{zh:'åº«å­˜åˆ†ç¾¤',en:'Inventory segmentation',ja:'åœ¨åº«ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³'}},
    {n:12, name:'Hierarchical',          cat:{zh:'åˆ†ç¾¤',en:'Clustering',ja:'ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°'}, status:true, uc:{zh:'éšå±¤å¼åˆ†ç¾¤',en:'Agglomerative grouping',ja:'å‡é›†å‹ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°'}},
    {n:13, name:'DBSCAN',                cat:{zh:'åˆ†ç¾¤',en:'Clustering',ja:'ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°'}, status:true, uc:{zh:'å¯†åº¦åˆ†ç¾¤',en:'Density-based clustering',ja:'å¯†åº¦ãƒ™ãƒ¼ã‚¹ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°'}},
    {n:14, name:'PCA',                   cat:{zh:'é™ç¶­',en:'Dim. Reduction',ja:'æ¬¡å…ƒå‰Šæ¸›'},  status:true, uc:{zh:'ç‰¹å¾µå£“ç¸®',en:'Feature compression',ja:'ç‰¹å¾´åœ§ç¸®'}},
    {n:15, name:'t-SNE',                 cat:{zh:'é™ç¶­',en:'Dim. Reduction',ja:'æ¬¡å…ƒå‰Šæ¸›'},  status:true, uc:{zh:'2D åµŒå…¥',en:'2D embedding',ja:'2DåŸ‹ã‚è¾¼ã¿'}},
    {n:16, name:'Q-Learning',            cat:{zh:'å¼·åŒ–å­¸ç¿’',en:'RL',ja:'å¼·åŒ–å­¦ç¿’'},          status:false, uc:{zh:'è£œè²¨ç­–ç•¥',en:'Reorder policy',ja:'ç™ºæ³¨ãƒãƒªã‚·ãƒ¼'}},
    {n:17, name:'DQN',                   cat:{zh:'æ·±åº¦ RL',en:'Deep RL',ja:'æ·±å±¤RL'},       status:false, uc:{zh:'å‹•æ…‹è£œè²¨',en:'Dynamic reorder',ja:'å‹•çš„ç™ºæ³¨'}},
    {n:18, name:'PPO',                   cat:{zh:'æ·±åº¦ RL',en:'Deep RL',ja:'æ·±å±¤RL'},       status:false, uc:{zh:'å€‰å„²èª¿åº¦',en:'Warehouse scheduling',ja:'å€‰åº«ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°'}},
    {n:19, name:'SAC',                   cat:{zh:'æ·±åº¦ RL',en:'Deep RL',ja:'æ·±å±¤RL'},       status:false, uc:{zh:'é€£çºŒæ§åˆ¶',en:'Continuous control',ja:'é€£ç¶šåˆ¶å¾¡'}},
    {n:20, name:'A2C',                   cat:{zh:'æ·±åº¦ RL',en:'Deep RL',ja:'æ·±å±¤RL'},       status:false, uc:{zh:'å¤šç›®æ¨™',en:'Multi-objective',ja:'å¤šç›®çš„'}},
    {n:21, name:'ANN / MLP',             cat:{zh:'æ·±åº¦å­¸ç¿’',en:'Deep Learning',ja:'æ·±å±¤å­¦ç¿’'}, status:true, uc:{zh:'åº«å­˜ç‹€æ…‹åˆ†é¡',en:'Stock status classification',ja:'åœ¨åº«ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ†é¡'}},
    {n:22, name:'CNN',                   cat:{zh:'æ·±åº¦å­¸ç¿’',en:'Deep Learning',ja:'æ·±å±¤å­¦ç¿’'}, status:false, uc:{zh:'å½±åƒå“æª¢',en:'Visual inspection',ja:'ç”»åƒå“è³ªæ¤œæŸ»'}},
    {n:23, name:'RNN',                   cat:{zh:'åºåˆ—æ¨¡å‹',en:'Sequence',ja:'ã‚·ãƒ¼ã‚±ãƒ³ã‚¹'},   status:false, uc:{zh:'éœ€æ±‚é æ¸¬',en:'Demand forecasting',ja:'éœ€è¦äºˆæ¸¬'}},
    {n:24, name:'LSTM',                  cat:{zh:'åºåˆ—æ¨¡å‹',en:'Sequence',ja:'ã‚·ãƒ¼ã‚±ãƒ³ã‚¹'},   status:false, uc:{zh:'æ™‚é–“åºåˆ—é æ¸¬',en:'Time-series forecasting',ja:'æ™‚ç³»åˆ—äºˆæ¸¬'}},
    {n:25, name:'Transformer',           cat:{zh:'åºåˆ—æ¨¡å‹',en:'Sequence',ja:'ã‚·ãƒ¼ã‚±ãƒ³ã‚¹'},   status:false, uc:{zh:'å¤šè®Šé‡é æ¸¬',en:'Multivariate forecast',ja:'å¤šå¤‰é‡äºˆæ¸¬'}},
    {n:26, name:'K-Means++',             cat:{zh:'åˆ†ç¾¤',en:'Clustering',ja:'ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°'}, status:true, uc:{zh:'æ”¹è‰¯åˆå§‹åŒ–',en:'Improved initialization',ja:'æ”¹è‰¯åˆæœŸåŒ–'}},
    {n:27, name:'Autoencoder',           cat:{zh:'ç•°å¸¸åµæ¸¬',en:'Anomaly',ja:'ç•°å¸¸æ¤œå‡º'},     status:true, uc:{zh:'é‡å»ºèª¤å·®ç•°å¸¸åµæ¸¬',en:'Reconstruction error anomaly',ja:'å†æ§‹æˆèª¤å·®ç•°å¸¸æ¤œå‡º'}},
    {n:28, name:'Isolation Forest',      cat:{zh:'ç•°å¸¸åµæ¸¬',en:'Anomaly',ja:'ç•°å¸¸æ¤œå‡º'},     status:true, uc:{zh:'é›¢ç¾¤å€¼åµæ¸¬',en:'Outlier detection',ja:'å¤–ã‚Œå€¤æ¤œå‡º'}},
    {n:29, name:'MDP',                   cat:{zh:'æ±ºç­–éç¨‹',en:'Decision Process',ja:'æ±ºå®šéç¨‹'}, status:false, uc:{zh:'æœ€ä½³ç­–ç•¥å»ºæ¨¡',en:'Optimal policy modeling',ja:'æœ€é©æ–¹ç­–ãƒ¢ãƒ‡ãƒªãƒ³ã‚°'}},
    {n:30, name:'Genetic Algorithm',     cat:{zh:'æœ€ä½³åŒ–',en:'Optimization',ja:'æœ€é©åŒ–'},   status:true, uc:{zh:'å®‰å…¨åº«å­˜æœ€ä½³åŒ–',en:'Safety stock optimization',ja:'å®‰å…¨åœ¨åº«æœ€é©åŒ–'}},
  ];

  let html = `<p style="font-size:13px;color:var(--text-muted);margin-bottom:16px">${t('click_enlarge')}</p>`;
  html += `<div class="chart-gallery">${charts.map(c => chartItemHTML(c.file, c.title, c.desc)).join('')}</div>`;

  // Algorithm table
  html += `<div class="card" style="margin-top:22px"><div class="card-hd"><h3>${t('hd_algo_summary')}</h3><span class="card-badge" style="background:rgba(139,92,246,.15);color:var(--accent-purple)">30</span></div>
    <div class="tbl-wrap"><table><thead><tr>
      <th>${t('algo_num')}</th><th>${t('algo_name')}</th><th>${t('algo_category')}</th><th>${t('algo_status')}</th><th>${t('algo_usecase')}</th>
    </tr></thead><tbody>`;
  algos.forEach(a => {
    const statusStyle = a.status
      ? 'background:rgba(16,185,129,.15);color:var(--accent-green)'
      : 'background:rgba(100,116,139,.15);color:var(--text-muted)';
    html += `<tr>
      <td style="font-weight:600;color:var(--text-muted)">${a.n}</td>
      <td style="font-weight:600">${a.name}</td>
      <td>${a.cat[S.lang] || a.cat.en}</td>
      <td><span class="status-tag" style="${statusStyle}">${a.status ? t('applied') : t('not_applicable')}</span></td>
      <td style="color:var(--text-secondary)">${a.uc[S.lang] || a.uc.en}</td>
    </tr>`;
  });
  html += `</tbody></table></div></div>`;
  return html;
}

function healthHTML() {
  let html = `<p style="font-size:13px;color:var(--text-muted);margin-bottom:16px">${t('click_enlarge')}</p>`;
  html += `<div class="chart-gallery">`;
  html += chartItemHTML('chart_0_Inventory Health & Stockout Risk.png', 'chart_0_title', 'chart_0_desc');
  html += `</div>`;

  // KPI Explanation cards
  const kpis = [
    {title:'kpi_dsi', desc:'kpi_dsi_desc', icon:'ğŸ“…', color:'var(--accent-blue)'},
    {title:'kpi_abc', desc:'kpi_abc_desc', icon:'ğŸ¯', color:'var(--accent-orange)'},
    {title:'kpi_reorder', desc:'kpi_reorder_desc', icon:'ğŸ”„', color:'var(--accent-cyan)'},
    {title:'kpi_oos', desc:'kpi_oos_desc', icon:'âš ï¸', color:'var(--accent-red)'},
  ];
  html += `<div class="card" style="margin-top:22px"><div class="card-hd"><h3>${t('hd_health_kpi')}</h3></div><div class="card-body">
    <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:14px">`;
  kpis.forEach(k => {
    html += `<div style="background:rgba(255,255,255,.03);border:1px solid var(--border);border-radius:10px;padding:16px">
      <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px">
        <span style="font-size:20px">${k.icon}</span>
        <span style="font-weight:600;color:${k.color};font-size:14px">${t(k.title)}</span>
      </div>
      <p style="font-size:12px;color:var(--text-secondary);line-height:1.6">${t(k.desc)}</p>
    </div>`;
  });
  html += `</div></div></div>`;

  // Extra stats from data
  if (S.data) {
    const kpi = computeKPIs(S.data);
    const extraStats = [
      {l:t('stat_total_products'), v:fmt(kpi.total), c:'var(--accent-blue)'},
      {l:t('stat_oos_rate'), v:kpi.oosRate.toFixed(1)+'%', c:'var(--accent-red)'},
      {l:t('stat_low_stock'), v:fmt(kpi.lowCount), c:'var(--accent-yellow)'},
      {l:t('stat_normal_stock'), v:fmt(kpi.normalCount), c:'var(--accent-green)'},
    ];
    html += `<div class="stats" style="margin-top:18px">${extraStats.map(i=>`<div class="stat"><div class="stat-label">${i.l}</div><div class="stat-val" style="color:${i.c}">${i.v}</div></div>`).join('')}</div>`;
  }
  return html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  Main Render
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function render() {
  renderNav();
  renderLangSwitch();
  const info = $('#info-label');
  if (info) info.textContent = t('data_source');

  const m = $('#main');
  let html = `<div class="main-hd"><h2>${t(TITLE_MAP[S.view]||'title_overview')}</h2><div class="hd-right"><span class="tag-static">STATIC</span><span>${localeDateStr()}</span></div></div>`;

  switch (S.view) {
    case 'overview':    html += overviewHTML(); break;
    case 'pipeline':    html += pipelineHTML(); break;
    case 'statistical': html += statisticalHTML(); break;
    case 'supplychain': html += supplychainHTML(); break;
    case 'aiml':        html += aimlHTML(); break;
    case 'health':      html += healthHTML(); break;
  }
  m.innerHTML = html;
}

// â”€â”€â”€ Boot â”€â”€â”€
loadData();
document.addEventListener('keydown', e => { if (e.key === 'Escape') closeLightbox(); });
</script>
</body>
</html>
